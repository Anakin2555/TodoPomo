# TodoPomo 需求说明书

## 1. 项目概述

### 1.1 项目简介
TodoPomo 是一款基于番茄工作法（Pomodoro Technique）的桌面时间管理工具，旨在帮助用户提高工作效率和专注力。该应用结合了任务管理和番茄计时器功能，提供完整的时间管理解决方案。

### 1.2 目标用户
- 需要提高工作效率的知识工作者
- 需要时间管理工具的学生
- 容易分心需要专注辅助的用户
- 希望量化工作时间的专业人士

### 1.3 核心价值
- **提高专注力**：通过番茄工作法帮助用户保持专注
- **任务管理**：清晰的任务列表和进度追踪
- **数据可视化**：直观展示工作时间和效率
- **智能提醒**：自动检测空闲状态，防止时间浪费

## 2. 功能需求

### 2.1 番茄计时器功能

#### 2.1.1 基础计时功能
- **专注时长设置**
  - 默认专注时长：40分钟
  - 支持自定义时长：25分钟、45分钟、60分钟、90分钟、120分钟
  - 可通过菜单配置修改默认时长

- **计时器控制**
  - 开始/暂停：一键控制计时器运行状态
  - 自动暂停：检测到用户空闲时自动暂停
  - 状态显示：清晰显示"进行中"或"已暂停"状态

- **可视化进度**
  - 环形进度条：直观显示剩余时间
  - 倒计时显示：分秒格式显示剩余时间
  - 进度动画：平滑的进度条动画效果

#### 2.1.2 休息提醒功能
- **短休息（小憩）**
  - 触发时机：每15分钟专注后自动提醒
  - 休息时长：30秒
  - 提醒方式：全屏或窗口化休息界面
  - 多屏支持：在所有显示器上同时显示提醒

- **长休息**
  - 触发时机：完成一个完整专注周期后
  - 休息时长：5分钟
  - 强制休息：全屏模式下无法跳过
  - 音频提示：休息开始和结束时播放提示音

#### 2.1.3 任务关联
- **任务选择**
  - 点击计时器中心区域选择任务
  - 下拉列表显示所有未完成任务
  - 支持"专注"模式（不关联具体任务）

- **任务提醒**
  - 开始专注时提醒选择任务
  - 5分钟未选择任务时再次提醒
  - 可通过设置关闭任务选择提醒

### 2.2 任务管理功能

#### 2.2.1 任务创建
- **快速添加**
  - 输入任务名称
  - 设置预计番茄钟数量（默认2个）
  - 回车键快速添加
  - 自动计算任务总时长

- **批量导入**
  - 支持从文本批量导入任务
  - 每行一个任务
  - 自动去重（相同名称的任务）

#### 2.2.2 任务编辑
- **基本编辑**
  - 修改任务名称
  - 调整番茄钟数量（增加/减少）
  - 查看已完成时间和剩余时间

- **任务状态**
  - 标记任务完成/未完成
  - 完成的任务自动从选择列表中隐藏
  - 支持删除任务

#### 2.2.3 任务进度追踪
- **实时进度**
  - 显示已完成时间 / 总时长
  - 进度条可视化
  - 剩余时间计算

- **到时提醒**
  - 任务剩余15分钟时提醒
  - 任务剩余5分钟时提醒
  - 任务剩余1分钟时提醒
  - 任务到时时系统通知

### 2.3 专注记录功能

#### 2.3.1 实时统计
- **当日统计**
  - 显示当日总专注时长
  - 与每日目标对比（默认8小时）
  - 进度条可视化展示

#### 2.3.2 历史记录
- **日历视图**
  - 月历显示有记录的日期
  - 点击日期查看详细记录
  - 高亮显示有专注记录的日期

- **详细记录**
  - 每条专注记录包含：任务名称、开始时间、结束时间、时长
  - 按时间倒序排列
  - 支持查看历史任务列表

#### 2.3.3 数据持久化
- **本地存储**
  - 使用 electron-store 存储数据
  - 按日期组织记录
  - 自动保存，无需手动操作

### 2.4 智能监控功能

#### 2.4.1 用户活动检测
- **鼠标活动监控**
  - 检测鼠标移动（阈值>3像素）
  - 10秒间隔检查
  - 记录最后活动时间

- **键盘活动监控**
  - 全局键盘事件监听
  - 任意按键视为活动
  - 实时更新活动状态

#### 2.4.2 空闲状态管理
- **空闲检测**
  - 5分钟无活动自动判定为空闲
  - 4分钟时预警提醒
  - 空闲时自动暂停计时器

- **状态恢复**
  - 检测到活动后自动恢复计时
  - 空闲期间不计入专注时间
  - 屏幕解锁后刷新数据

#### 2.4.3 系统事件处理
- **屏幕锁定**
  - 息屏时自动暂停计时
  - 停止活动监控
  - 保存当前状态

- **屏幕解锁**
  - 恢复活动监控
  - 刷新任务和记录数据
  - 进入空闲状态等待用户操作

### 2.5 系统集成功能

#### 2.5.1 托盘功能
- **托盘图标**
  - 显示应用图标
  - 点击显示主窗口
  - 悬停显示当前状态

- **托盘菜单**
  - 开始/暂停计时器
  - 显示主界面
  - 退出应用

- **状态提示**
  - 显示当前任务名称
  - 显示剩余时间
  - 显示距离下次小憩时间

#### 2.5.2 系统通知
- **通知类型**
  - 任务到时提醒
  - 空闲状态警告
  - 任务选择提醒
  - 休息结束提醒

- **通知特性**
  - Windows 原生通知
  - 自定义标题和内容
  - 自动消失（可配置时长）

#### 2.5.3 窗口管理
- **主窗口**
  - 默认尺寸：1200x800
  - 关闭时最小化到托盘
  - 单实例运行（防止多开）

- **休息窗口**
  - 全屏模式或窗口模式（可配置）
  - 多显示器支持
  - 强制休息模式（全屏时无法关闭）

## 3. 非功能需求

### 3.1 性能要求
- **启动速度**：应用启动时间 < 3秒
- **响应速度**：UI操作响应时间 < 100ms
- **内存占用**：运行时内存占用 < 200MB
- **后台运行**：最小化后不影响计时准确性

### 3.2 可用性要求
- **界面设计**：深色主题，减少视觉疲劳
- **操作简便**：核心功能一键操作
- **视觉反馈**：所有操作提供即时反馈
- **错误处理**：友好的错误提示信息

### 3.3 兼容性要求
- **操作系统**：Windows 10/11, macOS 10.14+
- **屏幕分辨率**：支持1920x1080及以上
- **多显示器**：支持多显示器配置

### 3.4 可靠性要求
- **数据安全**：本地数据自动保存，防止丢失
- **异常恢复**：应用崩溃后自动恢复状态
- **计时准确**：计时误差 < 1秒/小时

## 4. 用户界面需求

### 4.1 主界面布局
- **左侧区域**：番茄计时器
  - 环形进度条
  - 剩余时间显示
  - 当前任务显示
  - 开始/暂停按钮

- **右侧区域**：任务列表和历史记录
  - 任务列表标签页
  - 专注历史标签页
  - 添加任务输入框
  - 任务列表（可滚动）

### 4.2 交互设计
- **拖拽排序**：暂不支持（未来功能）
- **键盘快捷键**：回车添加任务
- **鼠标交互**：点击、悬停提示
- **触摸支持**：暂不支持

### 4.3 视觉设计
- **配色方案**
  - 主背景色：#1E1E1E（深灰）
  - 主色调：#00F2EA（青色）
  - 文字颜色：#FFFFFF（白色）
  - 次要文字：#999999（灰色）

- **字体**
  - 系统默认无衬线字体
  - 标题：粗体
  - 正文：常规

## 5. 配置需求

### 5.1 可配置项
- **专注时长**：25/40/45/60/90/120分钟
- **短休息时长**：30秒（默认）
- **长休息时长**：5分钟（默认）
- **短休息间隔**：15分钟（默认）
- **每日目标**：8小时（默认）
- **任务选择提醒**：开启/关闭
- **活动监控**：开启/关闭
- **休息模式**：全屏/窗口

### 5.2 配置存储
- 使用 electron-store 存储配置
- 配置即时生效
- 支持重置为默认值

## 6. 已知限制和未来优化

### 6.1 当前限制
- 不支持跨日任务自动重置
- 不支持任务优先级排序
- 不支持数据导出功能
- 不支持云同步

### 6.2 计划优化（来自TODO）
- **时间管理**
  - 零点自动重置
  - 暂停后恢复提醒
  - 任务到时提前提醒优化

- **用户体验**
  - 休息弹窗自定义选择
  - 休息前预告功能
  - 立即休息按钮
  - 长期任务支持（非当日任务）

- **系统监控**
  - 活动监控可选时间段
  - 手动暂停时的idle检测优化
  - 新增关闭活动监控模式（看电影、看书等场景）

- **任务管理**
  - 修复任务时长计算问题
  - 修复编辑任务时的总时长变化问题
  - 修复小于5分钟任务无法完成的问题

## 7. 验收标准

### 7.1 功能验收
- ✅ 番茄计时器正常运行，计时准确
- ✅ 任务添加、编辑、删除功能正常
- ✅ 专注记录正确保存和显示
- ✅ 空闲检测和自动暂停功能正常
- ✅ 休息提醒按时触发
- ✅ 系统通知正常显示

### 7.2 性能验收
- ✅ 应用启动速度满足要求
- ✅ UI操作流畅无卡顿
- ✅ 长时间运行稳定
- ✅ 内存占用在合理范围

### 7.3 用户体验验收
- ✅ 界面美观，符合设计规范
- ✅ 操作简单，易于上手
- ✅ 错误提示清晰友好
- ✅ 数据不丢失

---

**文档版本**：v1.0  
**最后更新**：2025-11-22  
**维护者**：Anakin
